# Overview

The GDC API is the external-facing REST API for GDC and drives the graphical interface of the GDC Data and Submission Portals. It is made available to external users for programmatic access to the same functionality provided by the portals. This includes searching for and downloading subsets of data files, metadata and annotations based on specific parameters and submitting files to GDC.

The GDC API uses JSON as its communication format, and standard HTTP methods like GET, PUT, POST and DELETE.

# Tools

A large variety of tools are available to visualize and prepare calls to the GDC API.

The following tools can be used to communicate with GDC API (non-exhaustive list):

| Tool        | Type     |
| ------------- |-------------|
| [Curl](http://curl.haxx.se/docs/manpage.html) 		| Command line tool |
| [HTTPie](https://github.com/jakubroztocil/httpie) 	| Command line tool |
| [Postman REST Client](https://chrome.google.com/webstore/detail/postman-rest-client-packa/fhbjgbiflinjbdggehcddcbncdddomop?hl=en) 														| Google Chrome standalone app |
| [Google Chrome](http://www.google.com/chrome/) 	  | Google Chrome web browser can be used to make API calls |
| [DHC](http://restlet.com/products/dhc/)           | Google Chrome plugin to test REST APIs |


The following online tools can be used to help build GDC API calls:


| Tool        | Description     |
| ------------- |-------------|
| [JSONLint](http://jsonlint.com/)| Validate JSON strings |
| [UrlDecode.org](http://urldecode.org/)| Decode/Encode url strings (for example, from { to %7B) |


**Note:** See Appendix C for an example of using jsonlint and urldecode for GET to POST conversion.


# Accessing GDC API

The GDC API contains two types of end-points:  

* **Search and retrieval endpoints**: These endpoints all support the same query logic and will produce similarly structured output.  

* **Single-purpose endpoints**: These endpoints have been created for a specific use (such as displaying API status or downloading data).

Before beginning work on the GDC API, test that it is responding by calling the status endpoint:

``` bash
curl 'https://gdc-api.nci.nih.gov/status'
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                               Dload  Upload   Total   Spent    Left  Speed
100    60  100    60    0     0   3264      0 --:--:-- --:--:-- --:--:--  3333
{
   "status": "OK",
   "tag": "0.2.13-spr4",
   "version": 1
}
```
**Note:** See also Appendix D - Displaying API calls using GDC Data Portal or Submission UI.

# Available GDC API Endpoints

## Data Search and Retrieval Endpoints

The following search and retrieval endpoints are available on the GDC API.

| Endpoints | Type | Description |
| --- | --- | --- |
| [files](/developers/gdc-application-programming-interface-api-users-guide/7-examples#files-endpoint-ex) | Search & Retrieval | Find all files with specific characteristics such as file_name, md5sum, data_format and others. |
| [cases](/developers/gdc-application-programming-interface-api-users-guide/7-examples#cases-endpoint-ex) | Search & Retrieval | Find all files related to a specific case, or sample donor. |
| [projects](/developers/gdc-application-programming-interface-api-users-guide/7-examples#project-endpoint-ex) | Search & Retrieval | Search all data generated by a project |
| [annotations](/developers/gdc-application-programming-interface-api-users-guide/7-examples#annotations-endpoint-ex) | Search & Retrieval | Search annotations added to data after curation |


## Submission Endpoints

The following data submission endpoints are available on the GDC API.

| Endpoints | Type | Description |
| --- | --- | --- |
| submission(/developers/gdc-application-programming-interface-api-users-guide/7-examples#submission-endpoint-ex) | Submission | Returns the available resources at the top level above programs i.e., registered programs |

## Single-purpose Endpoints

| Endpoints | Type | Description |
| --- | --- | --- |
| status(/developers/gdc-application-programming-interface-api-users-guide/7-examples#status-endpoint-ex) | Single-purpose | Get the API status and version information |
| **data** | Single-purpose | Used to download GDC data |

# Versioning

The API has built-in versioning support to allow users to select which major API version to use.

When no API version is specified, the API will use the current production version of the endpoint.

The API version can be specified between the endpoint name and the API URL.

**Example:** Using the production version of the GDC API.
```
	https://gdc-api.nci.nih.gov/files
```

**Example**: Using version 0 of the GDC API.
```
	https://gdc-api.nci.nih.gov/v0/files
```

# Request Headers, Response Headers and Status Codes

## Request Headers

The GDC API supports the following request headers:

| Request Header | Description |
| --- | --- |
| Content-Type | Specify the format of the request payload (this is what the user is providing). Must be application/json or application/xml. |
| Accept | Specify the format of the response payload (this is what the user will get back). Must be application/json, application/xml. |
| X-Auth-Token | The submitterâ€™s authorization token as provided by the GDC Authorization API. This is the information that authenticates and authorizes the user to download controlled data or submit data. See Obtaining a Token(/developers/gdc-application-programming-interface-api-users-guide/3-authentication-and-authorization#obtaining-a-token) |

## Response Headers

The API provides the following response headers

| Response Header | Description |
| --- | --- |
| Content-Type | Will be application/json or application/xml depending on the Accept header. |


## Status Codes

The GDC API can respond with the following codes:

| Status Code | Description |
| --- | --- |
| 200 OK | Success |
| 400 Bad Request | An entity or element of the query was not valid |
| 403 Forbidden | Unauthorized request |
| 404 Not Found | Requested element not found |

# Example of GDC API Call

## Open Access Call (Data Search)

Returns the two smallest files stored on the GDC.

```
curl  'https://gdc-api.nci.nih.gov/files?from=1&size=2&sort=file_size:asc&pretty=true'
```

## Controlled Access Call (Submission or Access to Controlled Data)

Download files 64cfcd9d-8a23-4f88-95b6-49c05c7cbde4 and 3a2eca3c-5aef-47ae-9d4f-344e1268aac0. _'REPLACE_WITH_A_TOKEN'_ should be replaced with an actual token downloaded from the GDC Data Portal or GDC Data Submission Portal.

``` bash
curl -H 'X-Auth-Token:REPLACE_WITH_A_TOKEN' -O https://gdc-api.nci.nih.gov:5000/data/64cfcd9d-8a23-4f88-95b6-49c05c7cbde4,3a2eca3c-5aef-47ae-9d4f-344e1268aac0
```

# Helper Features

The GDC API has a series of additional parameters to assist users in building queries.
Each Data Search and Retrieval endpoint is equipped with a "\_mapping" parameter, returning a list of fields available.

__Note__: The /projects/ endpoint will be used for examples in this section of the documentation.

## Calling any Endpoint with '\_mapping' URL Parameter
<a name="mapping_parameters"></a>

Any endpoint called with the \_mapping parameter will return a JSON response containing elements that can be used to query the endpoint.

``` bash
curl 'https://gdc-api.nci.nih.gov/projects/_mapping'
{
  "_mapping": {}
  , "defaults": []
  , "expand": []
  , "fields": []
  , "multi": []
  , "nested": []
}
```

__Note__: The above example has been simplified. Sections below will provide more details on this output.

## Output: \_mapping: {}

The "\_mapping" output is a list of objects, containing fields available through the API.

``` json
...
"_mapping": {
 "projects.disease_type": {
   "doc_type": "projects",
   "field": "disease_type",
   "type": "id"
 },
 "projects.name": {
   "doc_type": "projects",
   "field": "name",
   "type": "id"
 }
}
...
```

A similar list can be obtained through the "fields" output, which has more details such as the name of the Elastic Search document (doc_type), the field name and the type of value.
A list of supported types (such as string, long, float, ...) can be obtained on [Elastic Search Documentation](https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html).
